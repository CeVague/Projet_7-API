import warnings
warnings.filterwarnings("ignore")

import unittest
import json
import pandas as pd
import numpy as np
from flask import Flask, jsonify
from app import get_client_dataframe, get_client_prediction

client_line = {"SK_ID_CURR":100002,"TARGET":"1.0","NAME_CONTRACT_TYPE":0,"CODE_GENDER":"0.0","FLAG_OWN_CAR":0,"FLAG_OWN_REALTY":0,"CNT_CHILDREN":0,"AMT_INCOME_TOTAL":202500.0,"AMT_CREDIT":406597.5,"AMT_ANNUITY":24700.5,"AMT_GOODS_PRICE":351000.0,"REGION_POPULATION_RELATIVE":"0.0188","DAYS_BIRTH":-9461,"DAYS_EMPLOYED":"-637.0","DAYS_REGISTRATION":"-3648.0","DAYS_ID_PUBLISH":-2120,"OWN_CAR_AGE":"-1.0","FLAG_MOBIL":1,"FLAG_EMP_PHONE":1,"FLAG_WORK_PHONE":0,"FLAG_CONT_MOBILE":1,"FLAG_PHONE":1,"FLAG_EMAIL":0,"CNT_FAM_MEMBERS":"1.0","REGION_RATING_CLIENT":"2.0","REGION_RATING_CLIENT_W_CITY":"2.0","HOUR_APPR_PROCESS_START":10,"REG_REGION_NOT_LIVE_REGION":0,"REG_REGION_NOT_WORK_REGION":0,"LIVE_REGION_NOT_WORK_REGION":0,"REG_CITY_NOT_LIVE_CITY":0,"REG_CITY_NOT_WORK_CITY":0,"LIVE_CITY_NOT_WORK_CITY":0,"APARTMENTS_AVG":"0.0247","BASEMENTAREA_AVG":"0.0369","YEARS_BEGINEXPLUATATION_AVG":"0.972","YEARS_BUILD_AVG":"0.619","COMMONAREA_AVG":"0.0143","ELEVATORS_AVG":"0.0","ENTRANCES_AVG":"0.069","FLOORSMAX_AVG":"0.0833","FLOORSMIN_AVG":"0.125","LANDAREA_AVG":"0.0369","LIVINGAPARTMENTS_AVG":"0.0202","LIVINGAREA_AVG":"0.019","NONLIVINGAPARTMENTS_AVG":"0.0","NONLIVINGAREA_AVG":"0.0","APARTMENTS_MODE":"0.0252","BASEMENTAREA_MODE":"0.0383","YEARS_BEGINEXPLUATATION_MODE":"0.972","YEARS_BUILD_MODE":"0.6343","COMMONAREA_MODE":"0.0144","ELEVATORS_MODE":"0.0","ENTRANCES_MODE":"0.069","FLOORSMAX_MODE":"0.0833","FLOORSMIN_MODE":"0.125","LANDAREA_MODE":"0.0377","LIVINGAPARTMENTS_MODE":"0.022","LIVINGAREA_MODE":"0.0198","NONLIVINGAPARTMENTS_MODE":"0.0","NONLIVINGAREA_MODE":"0.0","APARTMENTS_MEDI":"0.025","BASEMENTAREA_MEDI":"0.0369","YEARS_BEGINEXPLUATATION_MEDI":"0.972","YEARS_BUILD_MEDI":"0.6245","COMMONAREA_MEDI":"0.0144","ELEVATORS_MEDI":"0.0","ENTRANCES_MEDI":"0.069","FLOORSMAX_MEDI":"0.0833","FLOORSMIN_MEDI":"0.125","LANDAREA_MEDI":"0.0375","LIVINGAPARTMENTS_MEDI":"0.0205","LIVINGAREA_MEDI":"0.0193","NONLIVINGAPARTMENTS_MEDI":"0.0","NONLIVINGAREA_MEDI":"0.0","TOTALAREA_MODE":"0.0149","EMERGENCYSTATE_MODE":"0.0","OBS_30_CNT_SOCIAL_CIRCLE":"2.0","DEF_30_CNT_SOCIAL_CIRCLE":"2.0","OBS_60_CNT_SOCIAL_CIRCLE":"2.0","DEF_60_CNT_SOCIAL_CIRCLE":"2.0","DAYS_LAST_PHONE_CHANGE":"-1134.0","FLAG_DOCUMENT_2":0,"FLAG_DOCUMENT_3":1,"FLAG_DOCUMENT_4":0,"FLAG_DOCUMENT_5":0,"FLAG_DOCUMENT_6":0,"FLAG_DOCUMENT_7":0,"FLAG_DOCUMENT_8":0,"FLAG_DOCUMENT_9":0,"FLAG_DOCUMENT_10":0,"FLAG_DOCUMENT_11":0,"FLAG_DOCUMENT_12":0,"FLAG_DOCUMENT_13":0,"FLAG_DOCUMENT_14":0,"FLAG_DOCUMENT_15":0,"FLAG_DOCUMENT_16":0,"FLAG_DOCUMENT_17":0,"FLAG_DOCUMENT_18":0,"FLAG_DOCUMENT_19":0,"FLAG_DOCUMENT_20":0,"FLAG_DOCUMENT_21":0,"AMT_REQ_CREDIT_BUREAU_HOUR":"0.0","AMT_REQ_CREDIT_BUREAU_DAY":"0.0","AMT_REQ_CREDIT_BUREAU_WEEK":"0.0","AMT_REQ_CREDIT_BUREAU_MON":"0.0","AMT_REQ_CREDIT_BUREAU_QRT":"0.0","AMT_REQ_CREDIT_BUREAU_YEAR":"1.0","SET":0,"NAME_TYPE_SUITE_Children":"0.0","NAME_TYPE_SUITE_Family":"0.0","NAME_TYPE_SUITE_Groupofpeople":"0.0","NAME_TYPE_SUITE_Other_A":"0.0","NAME_TYPE_SUITE_Other_B":"0.0","NAME_TYPE_SUITE_Spousepartner":"0.0","NAME_TYPE_SUITE_Unaccompanied":"1.0","NAME_INCOME_TYPE_Businessman":"0.0","NAME_INCOME_TYPE_Commercialassociate":"0.0","NAME_INCOME_TYPE_Maternityleave":"0.0","NAME_INCOME_TYPE_Pensioner":"0.0","NAME_INCOME_TYPE_Stateservant":"0.0","NAME_INCOME_TYPE_Student":"0.0","NAME_INCOME_TYPE_Unemployed":"0.0","NAME_INCOME_TYPE_Working":"1.0","NAME_EDUCATION_TYPE_Academicdegree":"0.0","NAME_EDUCATION_TYPE_Highereducation":"0.0","NAME_EDUCATION_TYPE_Incompletehigher":"0.0","NAME_EDUCATION_TYPE_Lowersecondary":"0.0","NAME_EDUCATION_TYPE_Secondarysecondaryspecial":"1.0","NAME_FAMILY_STATUS_Civilmarriage":"0.0","NAME_FAMILY_STATUS_Married":"0.0","NAME_FAMILY_STATUS_Separated":"0.0","NAME_FAMILY_STATUS_Singlenotmarried":"1.0","NAME_FAMILY_STATUS_Widow":"0.0","NAME_HOUSING_TYPE_Coopapartment":"0.0","NAME_HOUSING_TYPE_Houseapartment":"1.0","NAME_HOUSING_TYPE_Municipalapartment":"0.0","NAME_HOUSING_TYPE_Officeapartment":"0.0","NAME_HOUSING_TYPE_Rentedapartment":"0.0","NAME_HOUSING_TYPE_Withparents":"0.0","OCCUPATION_TYPE_Accountants":"0.0","OCCUPATION_TYPE_Cleaningstaff":"0.0","OCCUPATION_TYPE_Cookingstaff":"0.0","OCCUPATION_TYPE_Corestaff":"0.0","OCCUPATION_TYPE_Drivers":"0.0","OCCUPATION_TYPE_HRstaff":"0.0","OCCUPATION_TYPE_Highskilltechstaff":"0.0","OCCUPATION_TYPE_ITstaff":"0.0","OCCUPATION_TYPE_Laborers":"1.0","OCCUPATION_TYPE_LowskillLaborers":"0.0","OCCUPATION_TYPE_Managers":"0.0","OCCUPATION_TYPE_Medicinestaff":"0.0","OCCUPATION_TYPE_Privateservicestaff":"0.0","OCCUPATION_TYPE_Realtyagents":"0.0","OCCUPATION_TYPE_Salesstaff":"0.0","OCCUPATION_TYPE_Secretaries":"0.0","OCCUPATION_TYPE_Securitystaff":"0.0","OCCUPATION_TYPE_Waitersbarmenstaff":"0.0","WEEKDAY_APPR_PROCESS_START_FRIDAY":"0.0","WEEKDAY_APPR_PROCESS_START_MONDAY":"0.0","WEEKDAY_APPR_PROCESS_START_SATURDAY":"0.0","WEEKDAY_APPR_PROCESS_START_SUNDAY":"0.0","WEEKDAY_APPR_PROCESS_START_THURSDAY":"0.0","WEEKDAY_APPR_PROCESS_START_TUESDAY":"0.0","WEEKDAY_APPR_PROCESS_START_WEDNESDAY":"1.0","ORGANIZATION_TYPE_Advertising":"0.0","ORGANIZATION_TYPE_Agriculture":"0.0","ORGANIZATION_TYPE_Bank":"0.0","ORGANIZATION_TYPE_BusinessEntityType1":"0.0","ORGANIZATION_TYPE_BusinessEntityType2":"0.0","ORGANIZATION_TYPE_BusinessEntityType3":"1.0","ORGANIZATION_TYPE_Cleaning":"0.0","ORGANIZATION_TYPE_Construction":"0.0","ORGANIZATION_TYPE_Culture":"0.0","ORGANIZATION_TYPE_Electricity":"0.0","ORGANIZATION_TYPE_Emergency":"0.0","ORGANIZATION_TYPE_Government":"0.0","ORGANIZATION_TYPE_Hotel":"0.0","ORGANIZATION_TYPE_Housing":"0.0","ORGANIZATION_TYPE_Industrytype1":"0.0","ORGANIZATION_TYPE_Industrytype10":"0.0","ORGANIZATION_TYPE_Industrytype11":"0.0","ORGANIZATION_TYPE_Industrytype12":"0.0","ORGANIZATION_TYPE_Industrytype13":"0.0","ORGANIZATION_TYPE_Industrytype2":"0.0","ORGANIZATION_TYPE_Industrytype3":"0.0","ORGANIZATION_TYPE_Industrytype4":"0.0","ORGANIZATION_TYPE_Industrytype5":"0.0","ORGANIZATION_TYPE_Industrytype6":"0.0","ORGANIZATION_TYPE_Industrytype7":"0.0","ORGANIZATION_TYPE_Industrytype8":"0.0","ORGANIZATION_TYPE_Industrytype9":"0.0","ORGANIZATION_TYPE_Insurance":"0.0","ORGANIZATION_TYPE_Kindergarten":"0.0","ORGANIZATION_TYPE_LegalServices":"0.0","ORGANIZATION_TYPE_Medicine":"0.0","ORGANIZATION_TYPE_Military":"0.0","ORGANIZATION_TYPE_Mobile":"0.0","ORGANIZATION_TYPE_Other":"0.0","ORGANIZATION_TYPE_Police":"0.0","ORGANIZATION_TYPE_Postal":"0.0","ORGANIZATION_TYPE_Realtor":"0.0","ORGANIZATION_TYPE_Religion":"0.0","ORGANIZATION_TYPE_Restaurant":"0.0","ORGANIZATION_TYPE_School":"0.0","ORGANIZATION_TYPE_Security":"0.0","ORGANIZATION_TYPE_SecurityMinistries":"0.0","ORGANIZATION_TYPE_Selfemployed":"0.0","ORGANIZATION_TYPE_Services":"0.0","ORGANIZATION_TYPE_Telecom":"0.0","ORGANIZATION_TYPE_Tradetype1":"0.0","ORGANIZATION_TYPE_Tradetype2":"0.0","ORGANIZATION_TYPE_Tradetype3":"0.0","ORGANIZATION_TYPE_Tradetype4":"0.0","ORGANIZATION_TYPE_Tradetype5":"0.0","ORGANIZATION_TYPE_Tradetype6":"0.0","ORGANIZATION_TYPE_Tradetype7":"0.0","ORGANIZATION_TYPE_Transporttype1":"0.0","ORGANIZATION_TYPE_Transporttype2":"0.0","ORGANIZATION_TYPE_Transporttype3":"0.0","ORGANIZATION_TYPE_Transporttype4":"0.0","ORGANIZATION_TYPE_University":"0.0","FONDKAPREMONT_MODE_notspecified":"0.0","FONDKAPREMONT_MODE_orgspecaccount":"0.0","FONDKAPREMONT_MODE_regoperaccount":"1.0","FONDKAPREMONT_MODE_regoperspecaccount":"0.0","HOUSETYPE_MODE_blockofflats":"1.0","HOUSETYPE_MODE_specifichousing":"0.0","HOUSETYPE_MODE_terracedhouse":"0.0","WALLSMATERIAL_MODE_Block":"0.0","WALLSMATERIAL_MODE_Mixed":"0.0","WALLSMATERIAL_MODE_Monolithic":"0.0","WALLSMATERIAL_MODE_Others":"0.0","WALLSMATERIAL_MODE_Panel":"0.0","WALLSMATERIAL_MODE_Stonebrick":"1.0","WALLSMATERIAL_MODE_Wooden":"0.0","DAYS_EMPLOYED_PERC":"0.0673","INCOME_CREDIT_PERC":"0.498","INCOME_PER_PERSON":202500.0,"ANNUITY_INCOME_PERC":"0.12195","PAYMENT_RATE":"0.06076","EXT_SOURCE_MEAN":"0.083","EXT_SOURCE_MEAN_x_DAYS_EMPLOYED":"-52.9","AMT_CREDIT__AMT_GOODS_PRICE":55597.5,"AMT_CREDIT_r_AMT_GOODS_PRICE":"1.158","AMT_CREDIT_r_AMT_ANNUITY":"16.47","AMT_CREDIT_r_AMT_INCOME_TOTAL":"2.008","AMT_INCOME_TOTAL_r_12__AMT_ANNUITY":-7825.5,"AMT_INCOME_TOTAL_r_AMT_ANNUITY":"8.195","CNT_CHILDREN_r_CNT_FAM_MEMBERS":"0.0","BURO_DAYS_CREDIT_MIN":"-1437.0","BURO_DAYS_CREDIT_ENDDATE_MIN":"-1072.0","BURO_DAYS_CREDIT_ENDDATE_MAX":"780.0","BURO_DAYS_CREDIT_ENDDATE_MEAN":"-349.0","BURO_DAYS_CREDIT_UPDATE_MEAN":"-500.0","BURO_CREDIT_DAY_OVERDUE_MAX":"0.0","BURO_CREDIT_DAY_OVERDUE_MEAN":"0.0","BURO_AMT_CREDIT_SUM_MAX":450000.0,"BURO_AMT_CREDIT_SUM_MEAN":108131.9453125,"BURO_AMT_CREDIT_SUM_SUM":865055.5625,"BURO_AMT_CREDIT_SUM_DEBT_MAX":245781.0,"BURO_AMT_CREDIT_SUM_DEBT_MEAN":49156.19921875,"BURO_AMT_CREDIT_SUM_DEBT_SUM":245781.0,"BURO_AMT_CREDIT_SUM_OVERDUE_MEAN":0.0,"BURO_AMT_CREDIT_SUM_LIMIT_MEAN":7997.1411132812,"BURO_AMT_CREDIT_SUM_LIMIT_SUM":31988.564453125,"BURO_CNT_CREDIT_PROLONG_SUM":"0.0","BURO_MONTHS_BALANCE_MIN_MIN":"-47.0","BURO_MONTHS_BALANCE_MAX_MAX":"0.0","BURO_MONTHS_BALANCE_SIZE_MEAN":"13.75","BURO_MONTHS_BALANCE_SIZE_SUM":"110.0","BURO_CREDIT_ACTIVE_Active_MEDIAN":"0.0","BURO_CREDIT_ACTIVE_Baddebt_MEDIAN":"0.0","BURO_CREDIT_ACTIVE_Closed_MEDIAN":"1.0","BURO_CREDIT_ACTIVE_Sold_MEDIAN":"0.0","BURO_CREDIT_ACTIVE_nan_MEDIAN":"0.0","BURO_CREDIT_CURRENCY_currency1_MEDIAN":"1.0","BURO_CREDIT_CURRENCY_currency2_MEDIAN":"0.0","BURO_CREDIT_CURRENCY_currency3_MEDIAN":"0.0","BURO_CREDIT_CURRENCY_currency4_MEDIAN":"0.0","BURO_CREDIT_CURRENCY_nan_MEDIAN":"0.0","BURO_CREDIT_TYPE_Anothertypeofloan_MEDIAN":"0.0","BURO_CREDIT_TYPE_Carloan_MEDIAN":"0.0","BURO_CREDIT_TYPE_Cashloannonearmarked_MEDIAN":"0.0","BURO_CREDIT_TYPE_Consumercredit_MEDIAN":"0.5","BURO_CREDIT_TYPE_Creditcard_MEDIAN":"0.5","BURO_CREDIT_TYPE_Interbankcredit_MEDIAN":"0.0","BURO_CREDIT_TYPE_Loanforbusinessdevelopment_MEDIAN":"0.0","BURO_CREDIT_TYPE_Loanforpurchaseofsharesmarginlending_MEDIAN":"0.0","BURO_CREDIT_TYPE_Loanforthepurchaseofequipment_MEDIAN":"0.0","BURO_CREDIT_TYPE_Loanforworkingcapitalreplenishment_MEDIAN":"0.0","BURO_CREDIT_TYPE_Microloan_MEDIAN":"0.0","BURO_CREDIT_TYPE_Mobileoperatorloan_MEDIAN":"0.0","BURO_CREDIT_TYPE_Mortgage_MEDIAN":"0.0","BURO_CREDIT_TYPE_Realestateloan_MEDIAN":"0.0","BURO_CREDIT_TYPE_Unknowntypeofloan_MEDIAN":"0.0","BURO_CREDIT_TYPE_nan_MEDIAN":"0.0","BURO_STATUS_0_MEDIAN_MEDIAN":"0.0","BURO_STATUS_1_MEDIAN_MEDIAN":"0.0","BURO_STATUS_2_MEDIAN_MEDIAN":"0.0","BURO_STATUS_3_MEDIAN_MEDIAN":"0.0","BURO_STATUS_4_MEDIAN_MEDIAN":"0.0","BURO_STATUS_5_MEDIAN_MEDIAN":"0.0","BURO_STATUS_C_MEDIAN_MEDIAN":"0.0","BURO_STATUS_X_MEDIAN_MEDIAN":"0.0","BURO_STATUS_nan_MEDIAN_MEDIAN":"0.0","ACTIVE_DAYS_CREDIT_MIN":"-1042.0","ACTIVE_DAYS_CREDIT_ENDDATE_MIN":"780.0","ACTIVE_DAYS_CREDIT_ENDDATE_MAX":"780.0","ACTIVE_DAYS_CREDIT_ENDDATE_MEAN":"780.0","ACTIVE_DAYS_CREDIT_UPDATE_MEAN":"-15.5","ACTIVE_CREDIT_DAY_OVERDUE_MAX":"0.0","ACTIVE_CREDIT_DAY_OVERDUE_MEAN":"0.0","ACTIVE_AMT_CREDIT_SUM_MAX":450000.0,"ACTIVE_AMT_CREDIT_SUM_MEAN":240994.28125,"ACTIVE_AMT_CREDIT_SUM_SUM":481988.5625,"ACTIVE_AMT_CREDIT_SUM_DEBT_MAX":245781.0,"ACTIVE_AMT_CREDIT_SUM_DEBT_MEAN":122890.5,"ACTIVE_AMT_CREDIT_SUM_DEBT_SUM":245781.0,"ACTIVE_AMT_CREDIT_SUM_OVERDUE_MEAN":0.0,"ACTIVE_AMT_CREDIT_SUM_LIMIT_MEAN":15994.2822265625,"ACTIVE_AMT_CREDIT_SUM_LIMIT_SUM":31988.564453125,"ACTIVE_CNT_CREDIT_PROLONG_SUM":"0.0","ACTIVE_MONTHS_BALANCE_MIN_MIN":"-34.0","ACTIVE_MONTHS_BALANCE_MAX_MAX":"0.0","ACTIVE_MONTHS_BALANCE_SIZE_MEAN":"10.0","ACTIVE_MONTHS_BALANCE_SIZE_SUM":"20.0","CLOSED_DAYS_CREDIT_MIN":"-1437.0","CLOSED_DAYS_CREDIT_ENDDATE_MIN":"-1072.0","CLOSED_DAYS_CREDIT_ENDDATE_MAX":"85.0","CLOSED_DAYS_CREDIT_ENDDATE_MEAN":"-575.0","CLOSED_DAYS_CREDIT_UPDATE_MEAN":"-661.5","CLOSED_CREDIT_DAY_OVERDUE_MAX":"0.0","CLOSED_CREDIT_DAY_OVERDUE_MEAN":"0.0","CLOSED_AMT_CREDIT_SUM_MAX":135000.0,"CLOSED_AMT_CREDIT_SUM_MEAN":63844.5,"CLOSED_AMT_CREDIT_SUM_SUM":383067.0,"CLOSED_AMT_CREDIT_SUM_DEBT_MAX":0.0,"CLOSED_AMT_CREDIT_SUM_DEBT_MEAN":0.0,"CLOSED_AMT_CREDIT_SUM_DEBT_SUM":0.0,"CLOSED_AMT_CREDIT_SUM_OVERDUE_MEAN":0.0,"CLOSED_AMT_CREDIT_SUM_LIMIT_MEAN":0.0,"CLOSED_AMT_CREDIT_SUM_LIMIT_SUM":0.0,"CLOSED_CNT_CREDIT_PROLONG_SUM":"0.0","CLOSED_MONTHS_BALANCE_MIN_MIN":"-47.0","CLOSED_MONTHS_BALANCE_MAX_MAX":"0.0","CLOSED_MONTHS_BALANCE_SIZE_MEAN":"15.0","CLOSED_MONTHS_BALANCE_SIZE_SUM":"90.0","PREV_AMT_ANNUITY_MIN":9251.775390625,"PREV_AMT_ANNUITY_MAX":9251.775390625,"PREV_AMT_ANNUITY_MEAN":9251.775390625,"PREV_AMT_APPLICATION_MIN":179055.0,"PREV_AMT_APPLICATION_MAX":179055.0,"PREV_AMT_APPLICATION_MEAN":179055.0,"PREV_AMT_CREDIT_MIN":179055.0,"PREV_AMT_CREDIT_MAX":179055.0,"PREV_AMT_CREDIT_MEAN":179055.0,"PREV_APP_CREDIT_PERC_MIN":"1.0","PREV_APP_CREDIT_PERC_MAX":1.0,"PREV_APP_CREDIT_PERC_MEAN":"1.0","PREV_AMT_DOWN_PAYMENT_MIN":0.0,"PREV_AMT_DOWN_PAYMENT_MAX":0.0,"PREV_AMT_DOWN_PAYMENT_MEAN":0.0,"PREV_AMT_GOODS_PRICE_MIN":179055.0,"PREV_AMT_GOODS_PRICE_MAX":179055.0,"PREV_AMT_GOODS_PRICE_MEAN":179055.0,"PREV_HOUR_APPR_PROCESS_START_MIN":"9.0","PREV_HOUR_APPR_PROCESS_START_MAX":"9.0","PREV_HOUR_APPR_PROCESS_START_MEAN":"9.0","PREV_RATE_DOWN_PAYMENT_MIN":"0.0","PREV_RATE_DOWN_PAYMENT_MAX":"0.0","PREV_RATE_DOWN_PAYMENT_MEAN":"0.0","PREV_DAYS_DECISION_MIN":"-606.0","PREV_DAYS_DECISION_MAX":"-606.0","PREV_DAYS_DECISION_MEAN":"-606.0","PREV_CNT_PAYMENT_MEAN":"24.0","PREV_CNT_PAYMENT_SUM":"24.0","PREV_AMT_DELTA_APPLICATION_CREDIT_MIN":0.0,"PREV_AMT_DELTA_APPLICATION_CREDIT_MAX":0.0,"PREV_AMT_DELTA_APPLICATION_CREDIT_MEAN":0.0,"PREV_AMT_DELTA_APPLICATION_GOODS_PRICE_MIN":0.0,"PREV_AMT_DELTA_APPLICATION_GOODS_PRICE_MAX":0.0,"PREV_AMT_DELTA_APPLICATION_GOODS_PRICE_MEAN":0.0,"PREV_AMT_REMAIN_TO_PAY_MIN":0.0,"PREV_AMT_REMAIN_TO_PAY_MAX":0.0,"PREV_AMT_REMAIN_TO_PAY_MEAN":0.0,"PREV_DAYS_DELTA_DRAWING_DUE_MIN":"0.0","PREV_DAYS_DELTA_DRAWING_DUE_MAX":"0.0","PREV_DAYS_DELTA_DRAWING_DUE_MEAN":"0.0","PREV_DAYS_TERMINATION_LESS_500_SUM":"0.0","PREV_DAYS_TERMINATION_LESS_500_MEAN":"0.0","PREV_NAME_CONTRACT_TYPE_Cashloans_MEDIAN":"0.0","PREV_NAME_CONTRACT_TYPE_Consumerloans_MEDIAN":"1.0","PREV_NAME_CONTRACT_TYPE_Revolvingloans_MEDIAN":"0.0","PREV_NAME_CONTRACT_TYPE_nan_MEDIAN":"0.0","PREV_WEEKDAY_APPR_PROCESS_START_FRIDAY_MEDIAN":"0.0","PREV_WEEKDAY_APPR_PROCESS_START_MONDAY_MEDIAN":"0.0","PREV_WEEKDAY_APPR_PROCESS_START_SATURDAY_MEDIAN":"1.0","PREV_WEEKDAY_APPR_PROCESS_START_SUNDAY_MEDIAN":"0.0","PREV_WEEKDAY_APPR_PROCESS_START_THURSDAY_MEDIAN":"0.0","PREV_WEEKDAY_APPR_PROCESS_START_TUESDAY_MEDIAN":"0.0","PREV_WEEKDAY_APPR_PROCESS_START_WEDNESDAY_MEDIAN":"0.0","PREV_WEEKDAY_APPR_PROCESS_START_nan_MEDIAN":"0.0","PREV_FLAG_LAST_APPL_PER_CONTRACT_N_MEDIAN":"0.0","PREV_FLAG_LAST_APPL_PER_CONTRACT_Y_MEDIAN":"1.0","PREV_FLAG_LAST_APPL_PER_CONTRACT_nan_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Buildingahouseoranannex_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Businessdevelopment_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Buyingagarage_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Buyingaholidayhomeland_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Buyingahome_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Buyinganewcar_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Buyingausedcar_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Carrepairs_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Education_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Everydayexpenses_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Furniture_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Gasificationwatersupply_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Hobby_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Journey_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Medicine_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Moneyforathirdperson_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Other_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Paymentsonotherloans_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Purchaseofelectronicequipment_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Refusaltonamethegoal_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Repairs_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Urgentneeds_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_Weddinggiftholiday_MEDIAN":"0.0","PREV_NAME_CASH_LOAN_PURPOSE_XAP_MEDIAN":"1.0","PREV_NAME_CASH_LOAN_PURPOSE_nan_MEDIAN":"0.0","PREV_NAME_CONTRACT_STATUS_Approved_MEDIAN":"1.0","PREV_NAME_CONTRACT_STATUS_Canceled_MEDIAN":"0.0","PREV_NAME_CONTRACT_STATUS_Refused_MEDIAN":"0.0","PREV_NAME_CONTRACT_STATUS_Unusedoffer_MEDIAN":"0.0","PREV_NAME_CONTRACT_STATUS_nan_MEDIAN":"0.0","PREV_NAME_PAYMENT_TYPE_Cashthroughthebank_MEDIAN":"0.0","PREV_NAME_PAYMENT_TYPE_Cashlessfromtheaccountoftheemployer_MEDIAN":"0.0","PREV_NAME_PAYMENT_TYPE_Noncashfromyouraccount_MEDIAN":"0.0","PREV_NAME_PAYMENT_TYPE_nan_MEDIAN":"1.0","PREV_CODE_REJECT_REASON_CLIENT_MEDIAN":"0.0","PREV_CODE_REJECT_REASON_HC_MEDIAN":"0.0","PREV_CODE_REJECT_REASON_LIMIT_MEDIAN":"0.0","PREV_CODE_REJECT_REASON_SCO_MEDIAN":"0.0","PREV_CODE_REJECT_REASON_SCOFR_MEDIAN":"0.0","PREV_CODE_REJECT_REASON_SYSTEM_MEDIAN":"0.0","PREV_CODE_REJECT_REASON_VERIF_MEDIAN":"0.0","PREV_CODE_REJECT_REASON_XAP_MEDIAN":"1.0","PREV_CODE_REJECT_REASON_nan_MEDIAN":"0.0","PREV_NAME_TYPE_SUITE_Children_MEDIAN":"0.0","PREV_NAME_TYPE_SUITE_Family_MEDIAN":"0.0","PREV_NAME_TYPE_SUITE_Groupofpeople_MEDIAN":"0.0","PREV_NAME_TYPE_SUITE_Other_A_MEDIAN":"0.0","PREV_NAME_TYPE_SUITE_Other_B_MEDIAN":"0.0","PREV_NAME_TYPE_SUITE_Spousepartner_MEDIAN":"0.0","PREV_NAME_TYPE_SUITE_Unaccompanied_MEDIAN":"0.0","PREV_NAME_TYPE_SUITE_nan_MEDIAN":"1.0","PREV_NAME_CLIENT_TYPE_New_MEDIAN":"1.0","PREV_NAME_CLIENT_TYPE_Refreshed_MEDIAN":"0.0","PREV_NAME_CLIENT_TYPE_Repeater_MEDIAN":"0.0","PREV_NAME_CLIENT_TYPE_nan_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_AdditionalService_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Animals_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_AudioVideo_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_AutoAccessories_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_ClothingandAccessories_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Computers_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_ConstructionMaterials_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_ConsumerElectronics_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_DirectSales_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Education_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Fitness_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Furniture_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Gardening_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Homewares_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Insurance_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Jewelry_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_MedicalSupplies_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Medicine_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Mobile_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_OfficeAppliances_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Other_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_PhotoCinemaEquipment_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_SportandLeisure_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Tourism_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_Vehicles_MEDIAN":"1.0","PREV_NAME_GOODS_CATEGORY_Weapon_MEDIAN":"0.0","PREV_NAME_GOODS_CATEGORY_nan_MEDIAN":"0.0","PREV_NAME_PORTFOLIO_Cards_MEDIAN":"0.0","PREV_NAME_PORTFOLIO_Cars_MEDIAN":"0.0","PREV_NAME_PORTFOLIO_Cash_MEDIAN":"0.0","PREV_NAME_PORTFOLIO_POS_MEDIAN":"1.0","PREV_NAME_PORTFOLIO_nan_MEDIAN":"0.0","PREV_NAME_PRODUCT_TYPE_walkin_MEDIAN":"0.0","PREV_NAME_PRODUCT_TYPE_xsell_MEDIAN":"0.0","PREV_NAME_PRODUCT_TYPE_nan_MEDIAN":"1.0","PREV_CHANNEL_TYPE_APCashloan_MEDIAN":"0.0","PREV_CHANNEL_TYPE_Cardealer_MEDIAN":"0.0","PREV_CHANNEL_TYPE_Channelofcorporatesales_MEDIAN":"0.0","PREV_CHANNEL_TYPE_Contactcenter_MEDIAN":"0.0","PREV_CHANNEL_TYPE_Countrywide_MEDIAN":"0.0","PREV_CHANNEL_TYPE_Creditandcashoffices_MEDIAN":"0.0","PREV_CHANNEL_TYPE_RegionalLocal_MEDIAN":"0.0","PREV_CHANNEL_TYPE_Stone_MEDIAN":"1.0","PREV_CHANNEL_TYPE_nan_MEDIAN":"0.0","PREV_NAME_SELLER_INDUSTRY_Autotechnology_MEDIAN":"1.0","PREV_NAME_SELLER_INDUSTRY_Clothing_MEDIAN":"0.0","PREV_NAME_SELLER_INDUSTRY_Connectivity_MEDIAN":"0.0","PREV_NAME_SELLER_INDUSTRY_Construction_MEDIAN":"0.0","PREV_NAME_SELLER_INDUSTRY_Consumerelectronics_MEDIAN":"0.0","PREV_NAME_SELLER_INDUSTRY_Furniture_MEDIAN":"0.0","PREV_NAME_SELLER_INDUSTRY_Industry_MEDIAN":"0.0","PREV_NAME_SELLER_INDUSTRY_Jewelry_MEDIAN":"0.0","PREV_NAME_SELLER_INDUSTRY_MLMpartners_MEDIAN":"0.0","PREV_NAME_SELLER_INDUSTRY_Tourism_MEDIAN":"0.0","PREV_NAME_SELLER_INDUSTRY_nan_MEDIAN":"0.0","PREV_NAME_YIELD_GROUP_high_MEDIAN":"0.0","PREV_NAME_YIELD_GROUP_low_action_MEDIAN":"0.0","PREV_NAME_YIELD_GROUP_low_normal_MEDIAN":"1.0","PREV_NAME_YIELD_GROUP_middle_MEDIAN":"0.0","PREV_NAME_YIELD_GROUP_nan_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_CardStreet_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_CardXSell_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_Cash_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_CashStreethigh_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_CashStreetlow_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_CashStreetmiddle_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_CashXSellhigh_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_CashXSelllow_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_CashXSellmiddle_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_POShouseholdwithinterest_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_POShouseholdwithoutinterest_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_POSindustrywithinterest_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_POSindustrywithoutinterest_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_POSmobilewithinterest_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_POSmobilewithoutinterest_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_POSotherwithinterest_MEDIAN":"1.0","PREV_PRODUCT_COMBINATION_POSotherswithoutinterest_MEDIAN":"0.0","PREV_PRODUCT_COMBINATION_nan_MEDIAN":"0.0","APPROVED_AMT_ANNUITY_MIN":9251.775390625,"APPROVED_AMT_ANNUITY_MAX":9251.775390625,"APPROVED_AMT_ANNUITY_MEAN":9251.775390625,"APPROVED_AMT_APPLICATION_MIN":179055.0,"APPROVED_AMT_APPLICATION_MAX":179055.0,"APPROVED_AMT_APPLICATION_MEAN":179055.0,"APPROVED_AMT_CREDIT_MIN":179055.0,"APPROVED_AMT_CREDIT_MAX":179055.0,"APPROVED_AMT_CREDIT_MEAN":179055.0,"APPROVED_APP_CREDIT_PERC_MIN":"1.0","APPROVED_APP_CREDIT_PERC_MAX":"1.0","APPROVED_APP_CREDIT_PERC_MEAN":"1.0","APPROVED_AMT_DOWN_PAYMENT_MIN":0.0,"APPROVED_AMT_DOWN_PAYMENT_MAX":0.0,"APPROVED_AMT_DOWN_PAYMENT_MEAN":0.0,"APPROVED_AMT_GOODS_PRICE_MIN":179055.0,"APPROVED_AMT_GOODS_PRICE_MAX":179055.0,"APPROVED_AMT_GOODS_PRICE_MEAN":179055.0,"APPROVED_HOUR_APPR_PROCESS_START_MIN":"9.0","APPROVED_HOUR_APPR_PROCESS_START_MAX":"9.0","APPROVED_HOUR_APPR_PROCESS_START_MEAN":"9.0","APPROVED_RATE_DOWN_PAYMENT_MIN":"0.0","APPROVED_RATE_DOWN_PAYMENT_MAX":"0.0","APPROVED_RATE_DOWN_PAYMENT_MEAN":"0.0","APPROVED_DAYS_DECISION_MIN":"-606.0","APPROVED_DAYS_DECISION_MAX":"-606.0","APPROVED_DAYS_DECISION_MEAN":"-606.0","APPROVED_CNT_PAYMENT_MEAN":"24.0","APPROVED_CNT_PAYMENT_SUM":"24.0","APPROVED_AMT_DELTA_APPLICATION_CREDIT_MIN":0.0,"APPROVED_AMT_DELTA_APPLICATION_CREDIT_MAX":0.0,"APPROVED_AMT_DELTA_APPLICATION_CREDIT_MEAN":0.0,"APPROVED_AMT_DELTA_APPLICATION_GOODS_PRICE_MIN":"0.0","APPROVED_AMT_DELTA_APPLICATION_GOODS_PRICE_MAX":"0.0","APPROVED_AMT_DELTA_APPLICATION_GOODS_PRICE_MEAN":"0.0","APPROVED_AMT_REMAIN_TO_PAY_MIN":0.0,"APPROVED_AMT_REMAIN_TO_PAY_MAX":0.0,"APPROVED_AMT_REMAIN_TO_PAY_MEAN":0.0,"APPROVED_DAYS_DELTA_DRAWING_DUE_MIN":"0.0","APPROVED_DAYS_DELTA_DRAWING_DUE_MAX":"0.0","APPROVED_DAYS_DELTA_DRAWING_DUE_MEAN":"0.0","APPROVED_DAYS_TERMINATION_LESS_500_SUM":"0.0","APPROVED_DAYS_TERMINATION_LESS_500_MEAN":"0.0","REFUSED_AMT_ANNUITY_MIN":-1.0,"REFUSED_AMT_ANNUITY_MAX":-1.0,"REFUSED_AMT_ANNUITY_MEAN":-1.0,"REFUSED_AMT_APPLICATION_MIN":0.0,"REFUSED_AMT_APPLICATION_MAX":0.0,"REFUSED_AMT_APPLICATION_MEAN":0.0,"REFUSED_AMT_CREDIT_MIN":0.0,"REFUSED_AMT_CREDIT_MAX":0.0,"REFUSED_AMT_CREDIT_MEAN":0.0,"REFUSED_APP_CREDIT_PERC_MIN":"0.0","REFUSED_APP_CREDIT_PERC_MAX":0.0,"REFUSED_APP_CREDIT_PERC_MEAN":"0.0","REFUSED_AMT_DOWN_PAYMENT_MIN":0.0,"REFUSED_AMT_DOWN_PAYMENT_MAX":0.0,"REFUSED_AMT_DOWN_PAYMENT_MEAN":0.0,"REFUSED_AMT_GOODS_PRICE_MIN":0.0,"REFUSED_AMT_GOODS_PRICE_MAX":0.0,"REFUSED_AMT_GOODS_PRICE_MEAN":0.0,"REFUSED_HOUR_APPR_PROCESS_START_MIN":"0.0","REFUSED_HOUR_APPR_PROCESS_START_MAX":"0.0","REFUSED_HOUR_APPR_PROCESS_START_MEAN":"0.0","REFUSED_RATE_DOWN_PAYMENT_MIN":"0.0","REFUSED_RATE_DOWN_PAYMENT_MAX":"0.0","REFUSED_RATE_DOWN_PAYMENT_MEAN":"0.0","REFUSED_DAYS_DECISION_MIN":"0.0","REFUSED_DAYS_DECISION_MAX":"0.0","REFUSED_DAYS_DECISION_MEAN":"0.0","REFUSED_CNT_PAYMENT_MEAN":"0.0","REFUSED_CNT_PAYMENT_SUM":"0.0","REFUSED_AMT_DELTA_APPLICATION_CREDIT_MIN":0.0,"REFUSED_AMT_DELTA_APPLICATION_CREDIT_MAX":0.0,"REFUSED_AMT_DELTA_APPLICATION_CREDIT_MEAN":0.0,"REFUSED_AMT_DELTA_APPLICATION_GOODS_PRICE_MIN":0.0,"REFUSED_AMT_DELTA_APPLICATION_GOODS_PRICE_MAX":0.0,"REFUSED_AMT_DELTA_APPLICATION_GOODS_PRICE_MEAN":0.0,"REFUSED_AMT_REMAIN_TO_PAY_MIN":0.0,"REFUSED_AMT_REMAIN_TO_PAY_MAX":0.0,"REFUSED_AMT_REMAIN_TO_PAY_MEAN":0.0,"REFUSED_DAYS_DELTA_DRAWING_DUE_MIN":0.0,"REFUSED_DAYS_DELTA_DRAWING_DUE_MAX":0.0,"REFUSED_DAYS_DELTA_DRAWING_DUE_MEAN":0.0,"REFUSED_DAYS_TERMINATION_LESS_500_SUM":"0.0","REFUSED_DAYS_TERMINATION_LESS_500_MEAN":"0.0","POS_MONTHS_BALANCE_MAX":"-1.0","POS_MONTHS_BALANCE_MEAN":"-10.0","POS_MONTHS_BALANCE_SIZE":"19.0","POS_SK_DPD_MAX":"0.0","POS_SK_DPD_MEAN":"0.0","POS_SK_DPD_DEF_MAX":"0.0","POS_SK_DPD_DEF_MEAN":"0.0","POS_NAME_CONTRACT_STATUS_Active_MEDIAN":"1.0","POS_NAME_CONTRACT_STATUS_Amortizeddebt_MEDIAN":"0.0","POS_NAME_CONTRACT_STATUS_Approved_MEDIAN":"0.0","POS_NAME_CONTRACT_STATUS_Canceled_MEDIAN":"0.0","POS_NAME_CONTRACT_STATUS_Completed_MEDIAN":"0.0","POS_NAME_CONTRACT_STATUS_Demand_MEDIAN":"0.0","POS_NAME_CONTRACT_STATUS_Returnedtothestore_MEDIAN":"0.0","POS_NAME_CONTRACT_STATUS_Signed_MEDIAN":"0.0","POS_NAME_CONTRACT_STATUS_nan_MEDIAN":"0.0","POS_CNT_INSTALMENT_more_POS_CNT_INSTALMENT_FUTURE_MEDIAN":"1.0","POS_COUNT":"19.0","INSTAL_NUM_INSTALMENT_VERSION_NUNIQUE":"2.0","INSTAL_DPD_MAX":"0.0","INSTAL_DPD_MEAN":"0.0","INSTAL_DPD_SUM":0.0,"INSTAL_DBD_MAX":"31.0","INSTAL_DBD_MEAN":"20.42","INSTAL_DBD_SUM":"388.0","INSTAL_PAYMENT_PERC_MAX":1.0,"INSTAL_PAYMENT_PERC_MEAN":"1.0","INSTAL_PAYMENT_PERC_SUM":19.0,"INSTAL_PAYMENT_PERC_VAR":0.0,"INSTAL_PAYMENT_DIFF_MAX":0.0,"INSTAL_PAYMENT_DIFF_MEAN":0.0,"INSTAL_PAYMENT_DIFF_SUM":0.0,"INSTAL_PAYMENT_DIFF_VAR":0.0,"INSTAL_AMT_INSTALMENT_MAX":53093.74609375,"INSTAL_AMT_INSTALMENT_MEAN":11559.2470703125,"INSTAL_AMT_INSTALMENT_SUM":219625.6875,"INSTAL_AMT_PAYMENT_MIN":9251.775390625,"INSTAL_AMT_PAYMENT_MAX":53093.74609375,"INSTAL_AMT_PAYMENT_MEAN":11559.2470703125,"INSTAL_AMT_PAYMENT_SUM":219625.6875,"INSTAL_DAYS_ENTRY_PAYMENT_MAX":"-49.0","INSTAL_DAYS_ENTRY_PAYMENT_MEAN":"-315.5","INSTAL_DAYS_ENTRY_PAYMENT_SUM":-5993.0,"INSTAL_COUNT":"19.0","CC_MONTHS_BALANCE_MIN":"0.0","CC_MONTHS_BALANCE_MAX":"0.0","CC_MONTHS_BALANCE_MEAN":"0.0","CC_MONTHS_BALANCE_SUM":"0.0","CC_MONTHS_BALANCE_VAR":"0.0","CC_AMT_BALANCE_MIN":0.0,"CC_AMT_BALANCE_MAX":0.0,"CC_AMT_BALANCE_MEAN":0.0,"CC_AMT_BALANCE_SUM":0.0,"CC_AMT_BALANCE_VAR":0.0,"CC_AMT_CREDIT_LIMIT_ACTUAL_MIN":0.0,"CC_AMT_CREDIT_LIMIT_ACTUAL_MAX":0.0,"CC_AMT_CREDIT_LIMIT_ACTUAL_MEAN":0.0,"CC_AMT_CREDIT_LIMIT_ACTUAL_SUM":0.0,"CC_AMT_CREDIT_LIMIT_ACTUAL_VAR":0.0,"CC_AMT_DRAWINGS_ATM_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_ATM_CURRENT_MAX":0.0,"CC_AMT_DRAWINGS_ATM_CURRENT_MEAN":0.0,"CC_AMT_DRAWINGS_ATM_CURRENT_SUM":0.0,"CC_AMT_DRAWINGS_ATM_CURRENT_VAR":0.0,"CC_AMT_DRAWINGS_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_CURRENT_MAX":0.0,"CC_AMT_DRAWINGS_CURRENT_MEAN":0.0,"CC_AMT_DRAWINGS_CURRENT_SUM":0.0,"CC_AMT_DRAWINGS_CURRENT_VAR":0.0,"CC_AMT_DRAWINGS_OTHER_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_OTHER_CURRENT_MAX":0.0,"CC_AMT_DRAWINGS_OTHER_CURRENT_MEAN":0.0,"CC_AMT_DRAWINGS_OTHER_CURRENT_SUM":0.0,"CC_AMT_DRAWINGS_OTHER_CURRENT_VAR":0.0,"CC_AMT_DRAWINGS_POS_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_POS_CURRENT_MAX":0.0,"CC_AMT_DRAWINGS_POS_CURRENT_MEAN":0.0,"CC_AMT_DRAWINGS_POS_CURRENT_SUM":0.0,"CC_AMT_DRAWINGS_POS_CURRENT_VAR":0.0,"CC_AMT_INST_MIN_REGULARITY_MIN":"0.0","CC_AMT_INST_MIN_REGULARITY_MAX":0.0,"CC_AMT_INST_MIN_REGULARITY_MEAN":"0.0","CC_AMT_INST_MIN_REGULARITY_SUM":0.0,"CC_AMT_INST_MIN_REGULARITY_VAR":0.0,"CC_AMT_PAYMENT_CURRENT_MIN":0.0,"CC_AMT_PAYMENT_CURRENT_MAX":0.0,"CC_AMT_PAYMENT_CURRENT_MEAN":0.0,"CC_AMT_PAYMENT_CURRENT_SUM":0.0,"CC_AMT_PAYMENT_CURRENT_VAR":0.0,"CC_AMT_PAYMENT_TOTAL_CURRENT_MIN":0.0,"CC_AMT_PAYMENT_TOTAL_CURRENT_MAX":0.0,"CC_AMT_PAYMENT_TOTAL_CURRENT_MEAN":0.0,"CC_AMT_PAYMENT_TOTAL_CURRENT_SUM":0.0,"CC_AMT_PAYMENT_TOTAL_CURRENT_VAR":0.0,"CC_AMT_RECEIVABLE_PRINCIPAL_MIN":0.0,"CC_AMT_RECEIVABLE_PRINCIPAL_MAX":0.0,"CC_AMT_RECEIVABLE_PRINCIPAL_MEAN":0.0,"CC_AMT_RECEIVABLE_PRINCIPAL_SUM":0.0,"CC_AMT_RECEIVABLE_PRINCIPAL_VAR":0.0,"CC_AMT_RECIVABLE_MIN":0.0,"CC_AMT_RECIVABLE_MAX":0.0,"CC_AMT_RECIVABLE_MEAN":0.0,"CC_AMT_RECIVABLE_SUM":0.0,"CC_AMT_RECIVABLE_VAR":0.0,"CC_AMT_TOTAL_RECEIVABLE_MIN":0.0,"CC_AMT_TOTAL_RECEIVABLE_MAX":0.0,"CC_AMT_TOTAL_RECEIVABLE_MEAN":0.0,"CC_AMT_TOTAL_RECEIVABLE_SUM":0.0,"CC_AMT_TOTAL_RECEIVABLE_VAR":0.0,"CC_CNT_DRAWINGS_ATM_CURRENT_MIN":"0.0","CC_CNT_DRAWINGS_ATM_CURRENT_MAX":"0.0","CC_CNT_DRAWINGS_ATM_CURRENT_MEAN":"0.0","CC_CNT_DRAWINGS_ATM_CURRENT_SUM":"0.0","CC_CNT_DRAWINGS_ATM_CURRENT_VAR":"0.0","CC_CNT_DRAWINGS_CURRENT_MIN":"0.0","CC_CNT_DRAWINGS_CURRENT_MAX":"0.0","CC_CNT_DRAWINGS_CURRENT_MEAN":"0.0","CC_CNT_DRAWINGS_CURRENT_SUM":"0.0","CC_CNT_DRAWINGS_CURRENT_VAR":"0.0","CC_CNT_DRAWINGS_OTHER_CURRENT_MIN":"0.0","CC_CNT_DRAWINGS_OTHER_CURRENT_MAX":"0.0","CC_CNT_DRAWINGS_OTHER_CURRENT_MEAN":"0.0","CC_CNT_DRAWINGS_OTHER_CURRENT_SUM":"0.0","CC_CNT_DRAWINGS_OTHER_CURRENT_VAR":"0.0","CC_CNT_DRAWINGS_POS_CURRENT_MIN":"0.0","CC_CNT_DRAWINGS_POS_CURRENT_MAX":"0.0","CC_CNT_DRAWINGS_POS_CURRENT_MEAN":"0.0","CC_CNT_DRAWINGS_POS_CURRENT_SUM":"0.0","CC_CNT_DRAWINGS_POS_CURRENT_VAR":"0.0","CC_CNT_INSTALMENT_MATURE_CUM_MIN":"0.0","CC_CNT_INSTALMENT_MATURE_CUM_MAX":"0.0","CC_CNT_INSTALMENT_MATURE_CUM_MEAN":"0.0","CC_CNT_INSTALMENT_MATURE_CUM_SUM":"0.0","CC_CNT_INSTALMENT_MATURE_CUM_VAR":"0.0","CC_SK_DPD_MIN":"0.0","CC_SK_DPD_MAX":"0.0","CC_SK_DPD_MEAN":"0.0","CC_SK_DPD_SUM":0.0,"CC_SK_DPD_VAR":0.0,"CC_SK_DPD_DEF_MIN":"0.0","CC_SK_DPD_DEF_MAX":"0.0","CC_SK_DPD_DEF_MEAN":"0.0","CC_SK_DPD_DEF_SUM":0.0,"CC_SK_DPD_DEF_VAR":0.0,"CC_NAME_CONTRACT_STATUS_Active_MIN":"0.0","CC_NAME_CONTRACT_STATUS_Active_MAX":"0.0","CC_NAME_CONTRACT_STATUS_Active_MEAN":"0.0","CC_NAME_CONTRACT_STATUS_Active_SUM":"0.0","CC_NAME_CONTRACT_STATUS_Active_VAR":"0.0","CC_NAME_CONTRACT_STATUS_Approved_MIN":"0.0","CC_NAME_CONTRACT_STATUS_Approved_MAX":"0.0","CC_NAME_CONTRACT_STATUS_Approved_MEAN":"0.0","CC_NAME_CONTRACT_STATUS_Approved_SUM":"0.0","CC_NAME_CONTRACT_STATUS_Approved_VAR":"0.0","CC_NAME_CONTRACT_STATUS_Completed_MIN":"0.0","CC_NAME_CONTRACT_STATUS_Completed_MAX":"0.0","CC_NAME_CONTRACT_STATUS_Completed_MEAN":"0.0","CC_NAME_CONTRACT_STATUS_Completed_SUM":"0.0","CC_NAME_CONTRACT_STATUS_Completed_VAR":"0.0","CC_NAME_CONTRACT_STATUS_Demand_MIN":"0.0","CC_NAME_CONTRACT_STATUS_Demand_MAX":"0.0","CC_NAME_CONTRACT_STATUS_Demand_MEAN":"0.0","CC_NAME_CONTRACT_STATUS_Demand_SUM":"0.0","CC_NAME_CONTRACT_STATUS_Demand_VAR":"0.0","CC_NAME_CONTRACT_STATUS_Refused_MIN":"0.0","CC_NAME_CONTRACT_STATUS_Refused_MAX":"0.0","CC_NAME_CONTRACT_STATUS_Refused_MEAN":"0.0","CC_NAME_CONTRACT_STATUS_Refused_SUM":"0.0","CC_NAME_CONTRACT_STATUS_Refused_VAR":"0.0","CC_NAME_CONTRACT_STATUS_Sentproposal_MIN":"0.0","CC_NAME_CONTRACT_STATUS_Sentproposal_MAX":"0.0","CC_NAME_CONTRACT_STATUS_Sentproposal_MEAN":"0.0","CC_NAME_CONTRACT_STATUS_Sentproposal_SUM":"0.0","CC_NAME_CONTRACT_STATUS_Sentproposal_VAR":"0.0","CC_NAME_CONTRACT_STATUS_Signed_MIN":"0.0","CC_NAME_CONTRACT_STATUS_Signed_MAX":"0.0","CC_NAME_CONTRACT_STATUS_Signed_MEAN":"0.0","CC_NAME_CONTRACT_STATUS_Signed_SUM":"0.0","CC_NAME_CONTRACT_STATUS_Signed_VAR":"0.0","CC_NAME_CONTRACT_STATUS_nan_MIN":"0.0","CC_NAME_CONTRACT_STATUS_nan_MAX":"0.0","CC_NAME_CONTRACT_STATUS_nan_MEAN":"0.0","CC_NAME_CONTRACT_STATUS_nan_SUM":"0.0","CC_NAME_CONTRACT_STATUS_nan_VAR":"0.0","CC_SK_DPDMONTHS_BALANCE_MIN":"0.0","CC_SK_DPDMONTHS_BALANCE_MAX":"0.0","CC_SK_DPDMONTHS_BALANCE_MEAN":"0.0","CC_SK_DPDMONTHS_BALANCE_SUM":0.0,"CC_SK_DPDMONTHS_BALANCE_VAR":0.0,"CC_SK_DPD_DEFMONTHS_BALANCE_MIN":"0.0","CC_SK_DPD_DEFMONTHS_BALANCE_MAX":"0.0","CC_SK_DPD_DEFMONTHS_BALANCE_MEAN":"0.0","CC_SK_DPD_DEFMONTHS_BALANCE_SUM":0.0,"CC_SK_DPD_DEFMONTHS_BALANCE_VAR":0.0,"CC_SK_DPDSK_DPD_DEF_MIN":"0.0","CC_SK_DPDSK_DPD_DEF_MAX":"0.0","CC_SK_DPDSK_DPD_DEF_MEAN":"0.0","CC_SK_DPDSK_DPD_DEF_SUM":0.0,"CC_SK_DPDSK_DPD_DEF_VAR":0.0,"CC_AMT_TOTAL_RECEIVABLEAMT_RECIVABLE_MIN":"0.0","CC_AMT_TOTAL_RECEIVABLEAMT_RECIVABLE_MAX":"0.0","CC_AMT_TOTAL_RECEIVABLEAMT_RECIVABLE_MEAN":"0.0","CC_AMT_TOTAL_RECEIVABLEAMT_RECIVABLE_SUM":0.0,"CC_AMT_TOTAL_RECEIVABLEAMT_RECIVABLE_VAR":0.0,"CC_AMT_TOTAL_RECEIVABLEAMT_RECEIVABLE_PRINCIPAL_MIN":0.0,"CC_AMT_TOTAL_RECEIVABLEAMT_RECEIVABLE_PRINCIPAL_MAX":0.0,"CC_AMT_TOTAL_RECEIVABLEAMT_RECEIVABLE_PRINCIPAL_MEAN":0.0,"CC_AMT_TOTAL_RECEIVABLEAMT_RECEIVABLE_PRINCIPAL_SUM":0.0,"CC_AMT_TOTAL_RECEIVABLEAMT_RECEIVABLE_PRINCIPAL_VAR":0.0,"CC_AMT_RECIVABLEAMT_RECEIVABLE_PRINCIPAL_MIN":0.0,"CC_AMT_RECIVABLEAMT_RECEIVABLE_PRINCIPAL_MAX":0.0,"CC_AMT_RECIVABLEAMT_RECEIVABLE_PRINCIPAL_MEAN":0.0,"CC_AMT_RECIVABLEAMT_RECEIVABLE_PRINCIPAL_SUM":0.0,"CC_AMT_RECIVABLEAMT_RECEIVABLE_PRINCIPAL_VAR":0.0,"CC_AMT_BALANCEAMT_RECIVABLE_MIN":0.0,"CC_AMT_BALANCEAMT_RECIVABLE_MAX":0.0,"CC_AMT_BALANCEAMT_RECIVABLE_MEAN":"0.0","CC_AMT_BALANCEAMT_RECIVABLE_SUM":0.0,"CC_AMT_BALANCEAMT_RECIVABLE_VAR":0.0,"CC_AMT_BALANCEAMT_RECEIVABLE_PRINCIPAL_MIN":"0.0","CC_AMT_BALANCEAMT_RECEIVABLE_PRINCIPAL_MAX":0.0,"CC_AMT_BALANCEAMT_RECEIVABLE_PRINCIPAL_MEAN":0.0,"CC_AMT_BALANCEAMT_RECEIVABLE_PRINCIPAL_SUM":0.0,"CC_AMT_BALANCEAMT_RECEIVABLE_PRINCIPAL_VAR":0.0,"CC_AMT_BALANCEAMT_TOTAL_RECEIVABLE_MIN":0.0,"CC_AMT_BALANCEAMT_TOTAL_RECEIVABLE_MAX":0.0,"CC_AMT_BALANCEAMT_TOTAL_RECEIVABLE_MEAN":0.0,"CC_AMT_BALANCEAMT_TOTAL_RECEIVABLE_SUM":0.0,"CC_AMT_BALANCEAMT_TOTAL_RECEIVABLE_VAR":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_ATM_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_ATM_CURRENT_MAX":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_ATM_CURRENT_MEAN":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_ATM_CURRENT_SUM":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_ATM_CURRENT_VAR":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_OTHER_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_OTHER_CURRENT_MAX":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_OTHER_CURRENT_MEAN":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_OTHER_CURRENT_SUM":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_OTHER_CURRENT_VAR":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_POS_CURRENT_MIN":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_POS_CURRENT_MAX":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_POS_CURRENT_MEAN":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_POS_CURRENT_SUM":0.0,"CC_AMT_DRAWINGS_CURRENTAMT_DRAWINGS_POS_CURRENT_VAR":0.0,"CC_COUNT":"0.0","REFUSED_DAYS_TERMINATION_LESS_MEAN":"500","PREV_NAME_CLIENT_TYPE_MEDIAN":"New","BURO_CREDIT_TYPE_MEDIAN":"Consumercredit","ORGANIZATION_TYPE":"BusinessEntityType3","PREV_NAME_TYPE_SUITE_MEDIAN":None,"PREV_NAME_PORTFOLIO_MEDIAN":"POS","PREV_NAME_YIELD_GROUP_MEDIAN":"low_normal","PREV_NAME_SELLER_INDUSTRY_MEDIAN":"Autotechnology","PREV_NAME_CONTRACT_TYPE_MEDIAN":"Consumerloans","BURO_CREDIT_ACTIVE_MEDIAN":"Closed","BURO_CREDIT_CURRENCY_MEDIAN":"currency1","HOUSETYPE_MODE":"blockofflats","PREV_DAYS_TERMINATION_LESS_MEAN":"500","PREV_NAME_CASH_LOAN_PURPOSE_MEDIAN":"XAP","PREV_NAME_GOODS_CATEGORY_MEDIAN":"Vehicles","CC_NAME_CONTRACT_STATUS_MEAN":"Active","NAME_EDUCATION_TYPE":"Secondarysecondaryspecial","OCCUPATION_TYPE":"Laborers","PREV_FLAG_LAST_APPL_PER_CONTRACT_MEDIAN":"Y","PREV_PRODUCT_COMBINATION_MEDIAN":"POSotherwithinterest","PREV_CODE_REJECT_REASON_MEDIAN":"XAP","PREV_NAME_PAYMENT_TYPE_MEDIAN":None,"PREV_NAME_CONTRACT_STATUS_MEDIAN":"Approved","NAME_INCOME_TYPE":"Working","PREV_CHANNEL_TYPE_MEDIAN":"Stone","NAME_FAMILY_STATUS":"Singlenotmarried","CC_NAME_CONTRACT_STATUS_MIN":"Active","FONDKAPREMONT_MODE":"regoperaccount","FLAG_DOCUMENT":"3","POS_NAME_CONTRACT_STATUS_MEDIAN":"Active","NAME_HOUSING_TYPE":"Houseapartment","APPROVED_DAYS_TERMINATION_LESS_MEAN":"500","WALLSMATERIAL_MODE":"Stonebrick","NAME_TYPE_SUITE":"Unaccompanied","PREV_NAME_PRODUCT_TYPE_MEDIAN":None,"PREV_WEEKDAY_APPR_PROCESS_START_MEDIAN":"SATURDAY","CC_NAME_CONTRACT_STATUS_MAX":"Active"}
client_line = json.dumps(client_line)

class FlaskAppTestCase(unittest.TestCase):

    def setUp(self):
        self.app = Flask(__name__)
        self.app.testing = True

    def test_get_client_dataframe(self):
        with self.app.test_request_context("/dataframe", method="GET", json={"data": client_line}):
            response = get_client_dataframe()
            json_data = pd.DataFrame.from_dict(json.loads(response))

            # Vérification des valeurs renvoyées dans le JSON
            expected_columns = ["shap", "abs"]
            self.assertEqual(set(json_data.keys()), set(expected_columns))

            # Vérification des types de données dans le JSON
            for key, value in json_data.items():
                self.assertEqual(value.dtypes, np.dtype('float64'))

    def test_get_client_prediction(self):
        with self.app.test_request_context("/dataframe", method="GET", json={"data": client_line}):
            response = get_client_prediction()
            json_data = response.get_json()
            
            # Vérification des valeurs renvoyées
            self.assertEqual(json_data["result"], 1)
            self.assertTrue(json_data["result_proba"] > json_data["seuil"])
            self.assertTrue(json_data["seuil"] >= 0)
            self.assertTrue(json_data["seuil"] <= 1)

if __name__ == "__main__":
    unittest.main()